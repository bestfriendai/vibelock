-- Migration: Add suggested performance indexes for Supabase\n-- File: supabase/migrations/20250921000001_add_suggested_indexes.sql\n\n-- Index for approved comments by review for faster loading\nCREATE INDEX IF NOT EXISTS idx_comments_approved_review ON public.comments (review_id) WHERE moderation_status = 'approved';\n\n-- Index for approved evidence by review\nCREATE INDEX IF NOT EXISTS idx_evidence_approved_review ON public.evidence (review_id) WHERE moderation_status = 'approved';\n\n-- Partial index for pending reports for moderation queue\nCREATE INDEX IF NOT EXISTS idx_reports_pending ON public.reports (created_at DESC) WHERE status = 'pending';\n\n-- Index for user warnings expiring soon for cleanup\nCREATE INDEX IF NOT EXISTS idx_user_warnings_expiring ON public.user_warnings (expires_at) WHERE expires_at < NOW() + INTERVAL '7 days';\n\n-- Composite index for notifications unread by user and recency\nCREATE INDEX IF NOT EXISTS idx_notifications_unread_user_time ON public.notifications (user_id, created_at DESC) WHERE is_read = false;\n\n-- GIN index for full-text search on user usernames if needed for search\nCREATE INDEX IF NOT EXISTS idx_users_username_fts ON public.users USING GIN (to_tsvector('english', username));